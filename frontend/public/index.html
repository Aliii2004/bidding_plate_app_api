
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Auto Plate Bidding Platform</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-primary: #8B5CF6;
      --color-primary-hover: #7C3AED;
      --color-bg: #ffffff;
      --color-text: #1F2937;
      --color-text-muted: #6B7280;
      --color-border: #E5E7EB;
      --color-card: #ffffff;
      --color-card-hover: #F9FAFB;
      --color-input: #F3F4F6;
      --color-error: #EF4444;
      --color-success: #10B981;
      --radius: 0.5rem;
      --shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    body {
      background-color: var(--color-bg);
      color: var(--color-text);
      line-height: 1.5;
      padding: 0;
      margin: 0;
    }

    h1, h2, h3, h4 {
      color: var(--color-text);
      font-weight: 600;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    header {
      padding: 1.5rem 0;
      border-bottom: 1px solid var(--color-border);
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .app-title {
      font-size: 1.875rem;
      font-weight: 700;
      color: var(--color-primary);
    }

    .auth-container {
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--radius);
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      padding: 0.5rem 1rem;
      border: none;
    }

    .btn-primary {
      background-color: var(--color-primary);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--color-primary-hover);
    }

    .btn-outline {
      background-color: transparent;
      border: 1px solid var(--color-border);
      color: var(--color-text);
    }

    .btn-outline:hover {
      background-color: var(--color-input);
    }

    .btn-sm {
      padding: 0.25rem 0.5rem;
      font-size: 0.875rem;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid var(--color-border);
      margin: 2rem 0 1.5rem;
    }

    .tab {
      padding: 0.75rem 1.5rem;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      font-weight: 500;
    }

    .tab.active {
      border-bottom: 2px solid var(--color-primary);
      color: var(--color-primary);
    }

    .search-bar {
      display: flex;
      margin-bottom: 2rem;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .search-input {
      flex-grow: 1;
      max-width: 400px;
      padding: 0.75rem 1rem;
      border-radius: var(--radius);
      border: 1px solid var(--color-border);
      background-color: var(--color-input);
    }

    .sort-container {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .sort-select {
      padding: 0.5rem;
      border-radius: var(--radius);
      border: 1px solid var(--color-border);
      background-color: var(--color-input);
    }

    .card-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .card {
      background-color: var(--color-card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      transition: transform 0.2s, box-shadow 0.2s;
      border: 1px solid var(--color-border);
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .card-header {
      padding: 1.25rem 1.25rem 0.75rem;
      border-bottom: 1px solid var(--color-border);
    }

    .card-title {
      font-size: 1.25rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .card-badge {
      font-size: 0.75rem;
      padding: 0.25rem 0.5rem;
      background-color: #e5e7eb;
      color: var(--color-text-muted);
      border-radius: 9999px;
    }

    .card-description {
      color: var(--color-text-muted);
      margin-top: 0.5rem;
      font-size: 0.875rem;
    }

    .card-content {
      padding: 1rem 1.25rem;
    }

    .detail-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
    }

    .detail-label {
      color: var(--color-text-muted);
      font-size: 0.875rem;
    }

    .detail-value {
      font-weight: 500;
      font-size: 0.875rem;
    }

    .card-footer {
      padding: 1rem 1.25rem;
      border-top: 1px solid var(--color-border);
    }

    .form-group {
      margin-bottom: 1.25rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      font-size: 0.875rem;
    }

    .form-input {
      width: 100%;
      padding: 0.75rem 1rem;
      border-radius: var(--radius);
      border: 1px solid var(--color-border);
      background-color: var(--color-input);
    }

    .form-help {
      margin-top: 0.25rem;
      font-size: 0.75rem;
      color: var(--color-text-muted);
    }

    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 200px;
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 3px solid rgba(0, 0, 0, 0.1);
      border-radius: 50%;
      border-top-color: var(--color-primary);
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .error {
      padding: 1rem;
      color: var(--color-error);
      text-align: center;
    }

    .empty-state {
      padding: 3rem 1rem;
      text-align: center;
      background-color: rgba(0, 0, 0, 0.05);
      border-radius: var(--radius);
    }

    .modal-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 50;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s;
    }

    .modal-backdrop.show {
      opacity: 1;
      pointer-events: auto;
    }

    .modal {
      background-color: var(--color-bg);
      border-radius: var(--radius);
      max-width: 500px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }

    .modal-header {
      padding: 1.25rem;
      border-bottom: 1px solid var(--color-border);
    }

    .modal-title {
      font-size: 1.25rem;
      font-weight: 600;
    }

    .modal-description {
      margin-top: 0.5rem;
      color: var(--color-text-muted);
      font-size: 0.875rem;
    }

    .modal-body {
      padding: 1.25rem;
    }

    .modal-footer {
      padding: 1.25rem;
      border-top: 1px solid var(--color-border);
      display: flex;
      justify-content: flex-end;
      gap: 0.75rem;
    }

    .toast-container {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      z-index: 100;
    }

    .toast {
      background-color: var(--color-bg);
      border: 1px solid var(--color-border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-md);
      padding: 1rem;
      margin-top: 0.5rem;
      width: 300px;
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      animation: slideIn 0.3s ease-out;
    }

    .toast-title {
      font-weight: 600;
    }

    .toast-message {
      font-size: 0.875rem;
      color: var(--color-text-muted);
    }

    .toast-success {
      border-left: 4px solid var(--color-success);
    }

    .toast-error {
      border-left: 4px solid var(--color-error);
    }

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    footer {
      margin-top: 4rem;
      padding-top: 2rem;
      padding-bottom: 2rem;
      text-align: center;
      border-top: 1px solid var(--color-border);
      color: var(--color-text-muted);
      font-size: 0.875rem;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .card-grid {
        grid-template-columns: 1fr;
      }

      .search-bar {
        flex-direction: column;
      }

      .search-input, .sort-container {
        max-width: none;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-content">
        <h1 class="app-title">Auto Plate Palooza</h1>
        <div class="auth-container">
          <button id="login-btn" class="btn btn-primary">Login</button>
          <div id="user-info" class="user-info" style="display: none;">
            <span id="username-display"></span>
            <button id="logout-btn" class="btn btn-outline btn-sm">Logout</button>
          </div>
        </div>
      </div>
      <p style="color: var(--color-text-muted); margin-top: 0.5rem;">
        Bid on exclusive auto license plates - highest bid wins!
      </p>
    </header>

    <div class="tabs">
      <div class="tab active" data-tab="plates">Available Plates</div>
      <div class="tab" data-tab="mybids" style="display: none;">My Bids</div>
    </div>

    <div id="plates-tab" class="tab-content active">
      <div class="search-bar">
        <input 
          type="text" 
          id="search-input" 
          class="search-input" 
          placeholder="Search plate number..."
        >
        <div class="sort-container">
          <span style="color: var(--color-text-muted); font-size: 0.875rem;">Sort by:</span>
          <select id="sort-select" class="sort-select">
            <option value="deadline">Deadline (Ascending)</option>
            <option value="-deadline">Deadline (Descending)</option>
          </select>
        </div>
      </div>

      <div id="plates-loading" class="loading">
        <div class="spinner"></div>
      </div>

      <div id="plates-error" class="error" style="display: none;"></div>

      <div id="plates-grid" class="card-grid" style="display: none;"></div>

      <div id="plates-empty" class="empty-state" style="display: none;">
        No plates found matching your criteria
      </div>
    </div>

    <div id="mybids-tab" class="tab-content">
      <div id="bids-loading" class="loading">
        <div class="spinner"></div>
      </div>

      <div id="bids-container" style="display: none;"></div>

      <div id="bids-empty" class="empty-state" style="display: none;">
        You haven't placed any bids yet
      </div>
    </div>

    <footer>
      <p>&copy; 2023 Auto Plate Palooza. All rights reserved.</p>
    </footer>
  </div>

  <!-- Login Modal -->
  <div id="login-modal" class="modal-backdrop">
    <div class="modal">
      <div class="modal-header">
        <h2 class="modal-title">Login to Your Account</h2>
        <p class="modal-description">Enter your credentials to place bids on auto plates.</p>
      </div>
      <div class="modal-body">
        <form id="login-form">
          <div class="form-group">
            <label for="username" class="form-label">Username</label>
            <input 
              type="text" 
              id="username" 
              class="form-input" 
              placeholder="Enter your username" 
              required
            >
          </div>
          <div class="form-group">
            <label for="password" class="form-label">Password</label>
            <input 
              type="password" 
              id="password" 
              class="form-input" 
              placeholder="Enter your password" 
              required
            >
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button id="login-cancel" class="btn btn-outline">Cancel</button>
        <button id="login-submit" class="btn btn-primary">Login</button>
      </div>
    </div>
  </div>

  <!-- Bid Modal -->
  <div id="bid-modal" class="modal-backdrop">
    <div class="modal">
      <div class="modal-header">
        <h2 class="modal-title">Place a Bid</h2>
        <div id="bid-plate-info" class="modal-description"></div>
      </div>
      <div class="modal-body">
        <form id="bid-form">
          <div class="form-group">
            <label for="bid-amount" class="form-label">Your Bid Amount ($)</label>
            <input 
              type="number" 
              id="bid-amount" 
              class="form-input" 
              min="0.01" 
              step="0.01" 
              placeholder="Enter amount" 
              required
            >
            <p class="form-help">Your bid must be higher than the current highest bid.</p>
          </div>
          <input type="hidden" id="bid-plate-id">
        </form>
      </div>
      <div class="modal-footer">
        <button id="bid-cancel" class="btn btn-outline">Cancel</button>
        <button id="bid-submit" class="btn btn-primary">Submit Bid</button>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toast-container" class="toast-container"></div>

  <script>
    // API Configuration
    const API_URL = "http://localhost:8000"; // Replace with your actual backend URL

    // State Management
    let plates = [];
    let userBids = [];
    let isLoggedIn = false;
    let token = localStorage.getItem('token') || "";
    let currentUser = localStorage.getItem('username') || "";
    let searchTerm = "";
    let orderBy = "deadline";

    // Elements
    const platesGrid = document.getElementById('plates-grid');
    const platesLoading = document.getElementById('plates-loading');
    const platesError = document.getElementById('plates-error');
    const platesEmpty = document.getElementById('plates-empty');
    const searchInput = document.getElementById('search-input');
    const sortSelect = document.getElementById('sort-select');
    const loginBtn = document.getElementById('login-btn');
    const logoutBtn = document.getElementById('logout-btn');
    const loginModal = document.getElementById('login-modal');
    const loginForm = document.getElementById('login-form');
    const loginSubmit = document.getElementById('login-submit');
    const loginCancel = document.getElementById('login-cancel');
    const bidModal = document.getElementById('bid-modal');
    const bidForm = document.getElementById('bid-form');
    const bidSubmit = document.getElementById('bid-submit');
    const bidCancel = document.getElementById('bid-cancel');
    const bidAmount = document.getElementById('bid-amount');
    const bidPlateId = document.getElementById('bid-plate-id');
    const bidPlateInfo = document.getElementById('bid-plate-info');
    const userInfo = document.getElementById('user-info');
    const usernameDisplay = document.getElementById('username-display');
    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');
    const myBidsTab = document.querySelector('.tab[data-tab="mybids"]');
    const bidsContainer = document.getElementById('bids-container');
    const bidsLoading = document.getElementById('bids-loading');
    const bidsEmpty = document.getElementById('bids-empty');
    const toastContainer = document.getElementById('toast-container');

    // Initialize app
    document.addEventListener('DOMContentLoaded', initialize);

    function initialize() {
      // Check if user is logged in
      if (token && currentUser) {
        isLoggedIn = true;
        userInfo.style.display = 'flex';
        loginBtn.style.display = 'none';
        usernameDisplay.textContent = currentUser;
        myBidsTab.style.display = 'block';
        fetchUserBids();
      }

      // Fetch plates
      fetchPlates();

      // Add event listeners
      setupEventListeners();
    }

    function setupEventListeners() {
      // Search and sort
      searchInput.addEventListener('input', debounce(function() {
        searchTerm = this.value;
        fetchPlates();
      }, 300));

      sortSelect.addEventListener('change', function() {
        orderBy = this.value;
        fetchPlates();
      });

      // Auth
      loginBtn.addEventListener('click', function() {
        loginModal.classList.add('show');
      });

      loginCancel.addEventListener('click', function() {
        loginModal.classList.remove('show');
        loginForm.reset();
      });

      loginSubmit.addEventListener('click', handleLogin);

      logoutBtn.addEventListener('click', handleLogout);

      // Bid actions
      bidCancel.addEventListener('click', function() {
        bidModal.classList.remove('show');
        bidForm.reset();
      });

      bidSubmit.addEventListener('click', handleBid);

      // Tab switching
      tabs.forEach(tab => {
        tab.addEventListener('click', function() {
          const tabName = this.getAttribute('data-tab');
          switchTab(tabName);
        });
      });
    }

    // Tab switching
    function switchTab(tabName) {
      tabs.forEach(tab => {
        if (tab.getAttribute('data-tab') === tabName) {
          tab.classList.add('active');
        } else {
          tab.classList.remove('active');
        }
      });

      tabContents.forEach(content => {
        if (content.id === `${tabName}-tab`) {
          content.classList.add('active');
        } else {
          content.classList.remove('active');
        }
      });
    }

    // API Functions
    async function fetchPlates() {
      setPlatesLoading(true);
      try {
        let url = `${API_URL}/plates/?ordering=${orderBy}`;
        if (searchTerm) {
          url += `&plate_numbercontains=${encodeURIComponent(searchTerm)}`;
        }
        
        const response = await fetch(url);
        if (!response.ok) {
          throw new Error("Failed to fetch plates");
        }
        
        plates = await response.json();
        renderPlates();
        setPlatesLoading(false);
      } catch (error) {
        console.error("Error fetching plates:", error);
        platesError.textContent = "Failed to load plates. Please try again later.";
        platesError.style.display = 'block';
        platesGrid.style.display = 'none';
        platesEmpty.style.display = 'none';
        setPlatesLoading(false);
        showToast("Error", "Failed to load plates", "error");
      }
    }

    async function fetchUserBids() {
      if (!isLoggedIn) return;
      
      bidsLoading.style.display = 'flex';
      bidsContainer.style.display = 'none';
      bidsEmpty.style.display = 'none';
      
      try {
        const response = await fetch(`${API_URL}/bids/`, {
          headers: {
            Authorization: `Bearer ${token}`
          }
        });
        
        if (!response.ok) {
          throw new Error("Failed to fetch bids");
        }
        
        userBids = await response.json();
        
        if (userBids.length > 0) {
          renderUserBids();
          bidsContainer.style.display = 'block';
          bidsEmpty.style.display = 'none';
        } else {
          bidsContainer.style.display = 'none';
          bidsEmpty.style.display = 'block';
        }
      } catch (error) {
        console.error("Error fetching bids:", error);
        showToast("Error", "Failed to load your bids", "error");
      } finally {
        bidsLoading.style.display = 'none';
      }
    }

    async function handleLogin() {
      try {
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        if (!username || !password) {
          showToast("Error", "Username and password are required", "error");
          return;
        }
        
        const formData = new FormData();
        formData.append("username", username);
        formData.append("password", password);
        
        const response = await fetch(`${API_URL}/login/`, {
          method: "POST",
          body: formData
        });
        
        if (!response.ok) {
          throw new Error("Login failed");
        }
        
        const data = await response.json();
        token = data.access_token;
        currentUser = username;
        
        // Save to localStorage
        localStorage.setItem('token', token);
        localStorage.setItem('username', username);
        
        isLoggedIn = true;
        userInfo.style.display = 'flex';
        loginBtn.style.display = 'none';
        usernameDisplay.textContent = currentUser;
        myBidsTab.style.display = 'block';
        
        loginModal.classList.remove('show');
        loginForm.reset();
        
        showToast("Success", "You have successfully logged in", "success");
        
        // Fetch user bids after login
        fetchUserBids();
      } catch (error) {
        console.error("Login error:", error);
        showToast("Login Failed", "Invalid username or password", "error");
      }
    }

    function handleLogout() {
      // Clear auth data
      token = "";
      currentUser = "";
      isLoggedIn = false;
      userBids = [];
      
      // Clear localStorage
      localStorage.removeItem('token');
      localStorage.removeItem('username');
      
      // Update UI
      userInfo.style.display = 'none';
      loginBtn.style.display = 'block';
      myBidsTab.style.display = 'none';
      
      // Switch to plates tab if on my bids
      if (document.querySelector('.tab[data-tab="mybids"]').classList.contains('active')) {
        switchTab('plates');
      }
      
      showToast("Logged Out", "You have been logged out", "success");
    }

    async function handleBid() {
      if (!isLoggedIn) {
        showToast("Login Required", "Please login to place a bid", "error");
        bidModal.classList.remove('show');
        loginModal.classList.add('show');
        return;
      }
      
      try {
        const amount = parseFloat(bidAmount.value);
        const plateId = parseInt(bidPlateId.value);
        
        if (isNaN(amount) || amount <= 0) {
          showToast("Error", "Please enter a valid bid amount", "error");
          return;
        }
        
        const response = await fetch(`${API_URL}/bids/`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${token}`
          },
          body: JSON.stringify({
            amount: amount,
            plate_id: plateId
          })
        });
        
        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.detail || "Failed to place bid");
        }
        
        showToast("Bid Placed", "Your bid has been successfully placed", "success");
        
        bidModal.classList.remove('show');
        bidForm.reset();
        
        // Refresh plates and user bids
        fetchPlates();
        fetchUserBids();
      } catch (error) {
        console.error("Bid error:", error);
        showToast("Bid Failed", error.message, "error");
      }
    }

    // UI Functions
    function setPlatesLoading(isLoading) {
      if (isLoading) {
        platesLoading.style.display = 'flex';
        platesGrid.style.display = 'none';
        platesError.style.display = 'none';
        platesEmpty.style.display = 'none';
      } else {
        platesLoading.style.display = 'none';
      }
    }

    function renderPlates() {
      if (plates.length === 0) {
        platesGrid.style.display = 'none';
        platesEmpty.style.display = 'block';
        return;
      }
      
      platesGrid.innerHTML = '';
      platesGrid.style.display = 'grid';
      platesEmpty.style.display = 'none';
      
      plates.forEach(plate => {
        const isClosed = isBiddingClosed(plate.deadline);
        const cardEl = document.createElement('div');
        cardEl.className = `card ${isClosed ? 'closed' : ''}`;
        
        cardEl.innerHTML = `
          <div class="card-header">
            <div class="card-title">
              <span>${escapeHtml(plate.plate_number)}</span>
              ${isClosed ? '<span class="card-badge">Closed</span>' : ''}
            </div>
            <div class="card-description">${escapeHtml(plate.description)}</div>
          </div>
          <div class="card-content">
            <div class="detail-row">
              <span class="detail-label">Deadline:</span>
              <span class="detail-value">${formatDate(plate.deadline)}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Current Bid:</span>
              <span class="detail-value">
                ${plate.highest_bid ? `$${parseFloat(plate.highest_bid).toFixed(2)}` : 'No bids yet'}
              </span>
            </div>
          </div>
          <div class="card-footer">
            <button class="btn btn-primary" style="width: 100%;" 
              ${isClosed ? 'disabled' : ''} 
              data-plate-id="${plate.id}" 
              data-plate-number="${escapeHtml(plate.plate_number)}"
              data-highest-bid="${plate.highest_bid || 0}"
              onclick="openBidDialog(this)">
              Place Bid
            </button>
          </div>
        `;
        
        platesGrid.appendChild(cardEl);
      });
    }

    function renderUserBids() {
      bidsContainer.innerHTML = '';
      
      userBids.forEach(bid => {
        const bidEl = document.createElement('div');
        bidEl.className = 'card';
        bidEl.innerHTML = `
          <div class="card-header">
            <div class="card-title">Bid #${bid.id}</div>
            <div class="card-description">Placed on: ${formatDate(bid.created_at)}</div>
          </div>
          <div class="card-content">
            <div class="detail-row">
              <span class="detail-label">Plate ID:</span>
              <span class="detail-value">${bid.plate_id}</span>
            </div>
            <div class="detail-row">
              <span class="detail-label">Your Bid:</span>
              <span class="detail-value">$${parseFloat(bid.amount).toFixed(2)}</span>
            </div>
          </div>
        `;
        
        bidsContainer.appendChild(bidEl);
      });
    }

    function openBidDialog(element) {
      if (!isLoggedIn) {
        showToast("Login Required", "Please login to place a bid", "error");
        loginModal.classList.add('show');
        return;
      }
      
      const plateId = element.getAttribute('data-plate-id');
      const plateNumber = element.getAttribute('data-plate-number');
      const highestBid = element.getAttribute('data-highest-bid');
      
      bidPlateId.value = plateId;
      bidPlateInfo.innerHTML = `
        You are bidding on plate number: <strong>${escapeHtml(plateNumber)}</strong><br>
        Current highest bid: <strong>${
          parseFloat(highestBid) > 0 ? `$${parseFloat(highestBid).toFixed(2)}` : 'No bids yet'
        }</strong>
      `;
      
      bidModal.classList.add('show');
      bidAmount.focus();
    }

    function showToast(title, message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `toast toast-${type}`;
      toast.innerHTML = `
        <div class="toast-title">${escapeHtml(title)}</div>
        <div class="toast-message">${escapeHtml(message)}</div>
      `;
      
      toastContainer.appendChild(toast);
      
      // Auto remove after 5 seconds
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateX(100%)';
        setTimeout(() => {
          toast.remove();
        }, 300);
      }, 5000);
    }

    // Helper Functions
    function formatDate(dateString) {
      const options = { 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      };
      return new Date(dateString).toLocaleDateString(undefined, options);
    }

    function isBiddingClosed(deadline) {
      return new Date(deadline) < new Date();
    }

    function escapeHtml(html) {
      const div = document.createElement('div');
      div.textContent = html;
      return div.innerHTML;
    }

    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func.apply(this, args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // Expose function to global scope for inline onclick
    window.openBidDialog = openBidDialog;
  </script>
</body>
</html>
